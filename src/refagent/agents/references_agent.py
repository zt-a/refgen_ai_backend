from langchain_openai import ChatOpenAI

class ReferencesAgent:
    def __init__(self, model="gpt-4o-mini"):
        self.model = ChatOpenAI(model=model)

    def write(self, topic: str, language: str = "ru", count: int = 10):
        prompt = f"""
Ты — интеллектуальный агент, который составляет список корректных и проверяемых источников для академического реферата.

Тема: "{topic}"
Язык: {language}
Количество источников: {count}

Требования:
- Каждый источник должен быть реальным, научным и проверяемым.
- Допускаются книги, статьи, исследования.
- Никаких вымышленных или сомнительных источников.
- Формат записи источника строго такой:
    1. Фамилия, И. О. "Название источника". Город/Издательство, Год.
- Каждый источник с новой строки, пронумерован.
- Не добавляй слово "Использованные источники" в начале.
- Не добавляй лишнего текста или пояснений.
- Ответ оформляй строго в формате XML/HTML:
- Не используй markdown

<document>
    <content>
        ...тут выводи пронумерованный список источников...
    </content>
    <formulas>
        ...оставь пустым, так как здесь формул нет...
    </formulas>
</document>
"""



        result = self.model.invoke(prompt)
        return result.content
